<template><div><h2 id="reactá„‹á…ª-nodeá„…á…©-á„€á…®á„á…®á†¨á„’á…¡á†«-á„‹á…µá†«á„Œá…³á†¼-á„‹á…°á†¸-á„‹á…¢á†¸-á„‰á…©á„€á…¢" tabindex="-1"><a class="header-anchor" href="#reactá„‹á…ª-nodeá„…á…©-á„€á…®á„á…®á†¨á„’á…¡á†«-á„‹á…µá†«á„Œá…³á†¼-á„‹á…°á†¸-á„‹á…¢á†¸-á„‰á…©á„€á…¢" aria-hidden="true">#</a> Reactì™€ Nodeë¡œ êµ¬ì¶•í•œ ì¸ì¦ ì›¹ ì•± ì†Œê°œ</h2>
<p>ìš”ì¦˜ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ JWTì˜ ê°œë…ì´ ì ì ˆí•˜ê²Œ ë¬¸ì„œí™”ë˜ì§€ ì•Šê³  í”„ëŸ°íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œë¥¼ íŠ¹ì§•ìœ¼ë¡œ í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ì–´ë–»ê²Œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•´ ëª…í™•í•˜ê²Œ ì •ë¦¬ëœ ìë£Œë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ê¸°ë³¸ JWT ì‚¬ìš© ë°©ë²•ê³¼ ê´€ë ¨ëœ ë§í¬ ë° ê¸°ì‚¬ë“¤ì„ êµ¬ì²´ì ìœ¼ë¡œ ì •ë¦¬í•œ ë‚´ ì‘ì—… ë‚´ìš©ì„ ë¬¸ì„œí™”í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>
<p>ê°„ë‹¨í•œ ìš”ì•½: í”„ë¡œì íŠ¸ ì†Œê°œ</p>
<!-- ui-log ìˆ˜í‰í˜• -->
<p><ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-4877378276818686"
  data-ad-slot="9743150776"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins></p>
<component is="script">
(adsbygoogle = window.adsbygoogle || []).push({});
</component>
<p>íšŒì›ê°€ì… í”„ë¡œì„¸ìŠ¤:</p>
<ul>
<li>ì‚¬ìš©ìê°€ ê°€ì…ì„ ì™„ë£Œí•˜ë©´, í´ë¼ì´ì–¸íŠ¸ê°€ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„œë²„ë¡œ ë³´ëƒ…ë‹ˆë‹¤.</li>
<li>ì„œë²„ëŠ” ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°›ì€ í›„, ë¹„ë°€ë²ˆí˜¸ë¥¼ í•´ì‹±í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤.</li>
<li>ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤.</li>
</ul>
<p>ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤ (ì‹œìŠ¤í…œì˜ í•µì‹¬):</p>
<ul>
<li>ì‚¬ìš©ìëŠ” ë™ì¼í•œ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.</li>
<li>ì„œë²„ëŠ” ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°›ì€ í›„, ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê°€ì ¸ì™€ ì‚¬ìš©ìê°€ ë³´ë‚¸ ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„êµí•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  jwt:access-tokenê³¼ jwt:refresh-tokenì„ ìƒì„±í•©ë‹ˆë‹¤ (jwt:refresh-tokenì€ í•­ìƒ jwt:access-tokenë³´ë‹¤ ì˜¤ë˜ ì§€ì†ë˜ì–´ì•¼ í•©ë‹ˆë‹¤).</li>
<li>jwt:refresh-tokenì€ ì‚¬ìš©ìê°€ ê°€ì…í•  ë•Œ ì‚¬ìš©í•œ ì‚¬ìš©ì ì •ë³´ì™€ í•¨ê»˜ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë©ë‹ˆë‹¤.</li>
<li>ì„œë²„ëŠ” ê·¸ëŸ° ë‹¤ìŒ, jwt:access-tokenê³¼ jwt:refresh-tokenì„ &quot;Set-cookie&quot; í—¤ë”ë‚˜ expressë¥¼ ìœ„í•´ res.cookies(token, { httpOnly: true }) ë‚´ë¶€ì— ì„¤ì •í•˜ê³  ì‘ë‹µì„ í´ë¼ì´ì–¸íŠ¸ë¡œ ë‹¤ì‹œ ë³´ëƒ…ë‹ˆë‹¤ (ì‘ë‹µì—ëŠ” ì‚¬ìš©ì ì •ë³´ì™€ jwt:access-tokenì´ í¬í•¨ë¨).</li>
<li>í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë²„ë¡œë¶€í„° ì‘ë‹µì„ ë°›ì€ í›„, ì‚¬ìš©ìê°€ 'í™˜ì˜' í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤.</li>
</ul>
<!-- ui-log ìˆ˜í‰í˜• -->
<p><ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-4877378276818686"
  data-ad-slot="9743150776"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins></p>
<component is="script">
(adsbygoogle = window.adsbygoogle || []).push({});
</component>
<p>ë³´í˜¸ëœ ë¼ìš°íŠ¸ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ë°©ë²•:</p>
<ul>
<li>ì‚¬ìš©ìê°€ ë‹¤ìŒì— ë³´í˜¸ëœ ë¼ìš°íŠ¸ì— ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´ í´ë¼ì´ì–¸íŠ¸ëŠ” ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ê¸° ìœ„í•´ ì„œë²„ì— ìš”ì²­ê³¼ í•¨ê»˜ jwt:ì•¡ì„¸ìŠ¤ í† í°ì´ í¬í•¨ëœ ì¿ í‚¤ë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.</li>
<li>í•œ ë²ˆ ìœ íš¨ì„±ì´ ê²€ì‚¬ë˜ë©´ &quot;ì„±ê³µ&quot; ì‘ë‹µì´ ì „ì†¡ë˜ê³  ì‚¬ìš©ìê°€ ë³´í˜¸ëœ ë¼ìš°íŠ¸ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p>ì£¼ìš” ì‚¬í•­:</p>
<ul>
<li>refresh-tokenì€ access-tokenë³´ë‹¤ ì˜¤ë˜ ì§€ì†ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</li>
<li>ì¿ í‚¤ëŠ” ì„œë²„ì— ì˜í•´ì„œë§Œ ì¡°ì‘ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
<li>í† í°(jwt:ì•¡ì„¸ìŠ¤ í† í°, jwt:ë¦¬í”„ë ˆì‹œ í† í°)ì€ ì ˆëŒ€ í´ë¼ì´ì–¸íŠ¸ê°€ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ìœ„ì¹˜ì— ì €ì¥ë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤. ì¦‰, ë¡œì»¬ ìŠ¤í† ë¦¬ì§€, ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€.</li>
<li>&quot;Set-cookie&quot; ì‘ë‹µ í—¤ë”ëŠ” ë³´ì•ˆ ë¬¸ì œë¡œ ì¸í•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ì—†ìœ¼ë©° ê¸ˆì§€ëœ í—¤ë”ì˜ ì¼ë¶€ì…ë‹ˆë‹¤(ì¿ í‚¤ëŠ” ì„œë²„ì— ì˜í•´ì„œë§Œ ì¡°ì‘ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤).
ì¶”ê°€ ì •ë³´: https://fetch.spec.whatwg.org/#forbidden-response-header-name</li>
</ul>
<!-- ui-log ìˆ˜í‰í˜• -->
<p><ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-4877378276818686"
  data-ad-slot="9743150776"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins></p>
<component is="script">
(adsbygoogle = window.adsbygoogle || []).push({});
</component>
<h1 id="á„‹á…µá†«á„Œá…³á†¼-á„‹á…¢á†¸" tabindex="-1"><a class="header-anchor" href="#á„‹á…µá†«á„Œá…³á†¼-á„‹á…¢á†¸" aria-hidden="true">#</a> ì¸ì¦ ì•±</h1>
<p>ê¸°ë³¸ ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤ëŠ” ê°€ì •í•˜ì— ì§„í–‰í•©ë‹ˆë‹¤.</p>
<p>ë¨¼ì € íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// ì„œë²„</span>
<span class="token comment">// íšŒì›ê°€ì… ì»¨íŠ¸ë¡¤ëŸ¬</span>
<span class="token comment">// ./auth.controller.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">signUpUser</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">req</span><span class="token operator">:</span> Request<span class="token punctuation">,</span> <span class="token literal-property property">res</span><span class="token operator">:</span> Response</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> <span class="token punctuation">{</span> email<span class="token punctuation">,</span> password <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>

 <span class="token keyword">const</span> emailExists <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">checkIfEmailExists</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>emailExists<span class="token punctuation">)</span>
  <span class="token keyword">return</span> res
   <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤. ë¡œê·¸ì¸í•˜ëŸ¬ ì´ë™"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">const</span> hashedPassword <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">hash</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>hashedPassword <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">createNewUser</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> hashedPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>

 res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"ì‚¬ìš©ìê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!-- ui-log ìˆ˜í‰í˜• -->
<p><ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-4877378276818686"
  data-ad-slot="9743150776"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins></p>
<component is="script">
(adsbygoogle = window.adsbygoogle || []).push({});
</component>
<p>ë¡œê·¸ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì•¡ì„¸ìŠ¤ í† í° ìƒì„±ê¸°</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// ì„œë²„</span>
<span class="token comment">// ./auth.controller.ts</span>
<span class="token comment">// ì•¡ì„¸ìŠ¤ ë° ë¦¬í”„ë ˆì‹œ í† í° ìƒì„±</span>
<span class="token keyword">const</span> <span class="token function-variable function">generateAccessAndRefreshToken</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>
 <span class="token parameter"><span class="token literal-property property">email</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
 <span class="token literal-property property">password</span><span class="token operator">:</span> string</span>
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> accessToken <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>
   <span class="token punctuation">{</span> email<span class="token punctuation">,</span> password <span class="token punctuation">}</span><span class="token punctuation">,</span>
   process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ACCESS_TOKEN_SECRET</span><span class="token operator">!</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span> <span class="token literal-property property">expiresIn</span><span class="token operator">:</span> <span class="token string">"10s"</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> refreshToken <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>
   <span class="token punctuation">{</span> email<span class="token punctuation">,</span> password <span class="token punctuation">}</span><span class="token punctuation">,</span>
   process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">REFRESH_TOKEN_SECRET</span><span class="token operator">!</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span> <span class="token literal-property property">expiresIn</span><span class="token operator">:</span> <span class="token string">"1d"</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> accessToken<span class="token punctuation">,</span> refreshToken <span class="token punctuation">}</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
   <span class="token string">"í† í° ìƒì„± ì¤‘ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ./auth.controller.ts</span>
<span class="token comment">// ë¡œê·¸ì¸ ì»¨íŠ¸ë¡¤ëŸ¬</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">loginUser</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">req</span><span class="token operator">:</span> Request<span class="token punctuation">,</span> <span class="token literal-property property">res</span><span class="token operator">:</span> Response</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> <span class="token punctuation">{</span> email<span class="token punctuation">,</span> password <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>

 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"email:"</span><span class="token punctuation">,</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">const</span> emailExists <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">checkIfEmailExists</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>emailExists<span class="token punctuation">)</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"ë¨¼ì € ê°€ì…í•˜ì„¸ìš”!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">const</span> passFromDb <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getPasswordFromDb</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>passFromDb<span class="token punctuation">)</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"ì˜ëª»ëœ ìê²© ì¦ëª…!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> passFromDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">)</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"ìœ íš¨í•˜ì§€ ì•Šì€ ìê²© ì¦ëª…"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">const</span> <span class="token punctuation">{</span> accessToken<span class="token punctuation">,</span> refreshToken <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">generateAccessAndRefreshToken</span><span class="token punctuation">(</span>
  email<span class="token punctuation">,</span>
  password
 <span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token function">saveRefreshTokenToDb</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> refreshToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">"accesstoken"</span><span class="token punctuation">,</span> accessToken<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">httpOnly</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">"refreshtoken"</span><span class="token punctuation">,</span> refreshToken<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">httpOnly</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"ë¡œê·¸ì¸ ì„±ê³µ!! ë¡œë”© ì¤‘..."</span><span class="token punctuation">,</span> accessToken <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// í´ë¼ì´ì–¸íŠ¸</span>
<span class="token comment">// ./SignUp.tsx</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_BACKEND</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/auth/signup</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
   <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
   <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"Content-type"</span><span class="token operator">:</span> <span class="token string">"application/json"</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ./Login.tsx</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_BACKEND</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/auth/login</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
   <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
   <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"Content-type"</span><span class="token operator">:</span> <span class="token string">"application/json"</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token string">"include"</span><span class="token punctuation">,</span>
   <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!-- ui-log ìˆ˜í‰í˜• -->
<p><ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-4877378276818686"
  data-ad-slot="9743150776"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins></p>
<component is="script">
(adsbygoogle = window.adsbygoogle || []).push({});
</component>
<p>í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì¿ í‚¤ë¥¼ ë°›ìœ¼ë ¤ë©´ corsë¥¼ í—ˆìš©í•´ì•¼ í•´ìš”</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// ì„œë²„</span>
<span class="token comment">// ./server.ts</span>
<span class="token keyword">import</span> cookieParser <span class="token keyword">from</span> <span class="token string">"cookie-parser"</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
 <span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">origin</span><span class="token operator">:</span> <span class="token string">"http://localhost:5173"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cookieParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ë°±ì—”ë“œë¡œë¶€í„° ì‘ë‹µì„ ë°›ì€ í›„, ë¡œê·¸ì¸ ì‹œ ì¸ì¦ ì»¨í…ìŠ¤íŠ¸ ìƒíƒœë¥¼ ì„¤ì •í•˜ê³  accesstokenì„ ì„¤ì •í•©ë‹ˆë‹¤</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// í´ë¼ì´ì–¸íŠ¸</span>
<span class="token comment">// ./Login.tsx</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> message<span class="token punctuation">,</span> accessToken <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ì„±ê³µ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   accessToken<span class="token punctuation">,</span>
   <span class="token literal-property property">email</span><span class="token operator">:</span> formData<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
   <span class="token literal-property property">password</span><span class="token operator">:</span> formData<span class="token punctuation">.</span>password<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">navigate</span><span class="token punctuation">(</span><span class="token string">"/welcome"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"ì‘ë‹µì— ì˜¤ë¥˜ê°€ ìˆì–´ìš”"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!-- ui-log ìˆ˜í‰í˜• -->
<p><ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-4877378276818686"
  data-ad-slot="9743150776"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins></p>
<component is="script">
(adsbygoogle = window.adsbygoogle || []).push({});
</component>
<p>ì‚¬ìš©ìê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œê·¸ì¸ë˜ì—ˆìœ¼ë©° ì¿ í‚¤ê°€ ë¸Œë¼ìš°ì €ì— ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<p>ë³´í˜¸ëœ ê²½ë¡œì— ì‚¬ìš©ìê°€ ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´ ë¸Œë¼ìš°ì € ì¿ í‚¤ì— jwt:accesstokenì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” middlewareë¡œ authenticateTokenì´ ì •ì˜ëœ route checkì´ ìˆìŠµë‹ˆë‹¤.</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// ì„œë²„</span>
<span class="token comment">// ./routes/check.ts</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/check"</span><span class="token punctuation">,</span> authenticateToken<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token string">"success"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ./auth.middleware.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">authenticateToken</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
 <span class="token parameter"><span class="token literal-property property">req</span><span class="token operator">:</span> Request<span class="token punctuation">,</span>
 <span class="token literal-property property">res</span><span class="token operator">:</span> Response<span class="token punctuation">,</span>
 <span class="token literal-property property">next</span><span class="token operator">:</span> NextFunction</span>
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> token <span class="token operator">=</span>
  req<span class="token punctuation">.</span>cookies<span class="token operator">?.</span>accesstoken <span class="token operator">||</span>
  req<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Authorization"</span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"Bearer "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">verifyToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"user:"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ì¸ì¦ ì˜¤ë¥˜"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"ì¸ê°€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ì´ì œ ì‚¬ìš©ìê°€ ë³´í˜¸ëœ ê²½ë¡œì— ì•¡ì„¸ìŠ¤í•˜ë ¤ê³  í•  ë•Œë§ˆë‹¤ í´ë¼ì´ì–¸íŠ¸ëŠ” ìš”ì²­ê³¼ í•¨ê»˜ jwt:accesstoken ì¿ í‚¤ë¥¼ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤.</p>
<!-- ui-log ìˆ˜í‰í˜• -->
<p><ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-4877378276818686"
  data-ad-slot="9743150776"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins></p>
<component is="script">
(adsbygoogle = window.adsbygoogle || []).push({});
</component>
<h1 id="á„€á…§á†¯á„…á…©á†«" tabindex="-1"><a class="header-anchor" href="#á„€á…§á†¯á„…á…©á†«" aria-hidden="true">#</a> ê²°ë¡ </h1>
<p>ì´ê²ƒì€ JWT í† í°ì´ ê¸°ë³¸ ì¸ì¦ì— ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€ì— ëŒ€í•œ ê¸°ë³¸ ê°œìš”ì˜€ìŠµë‹ˆë‹¤. ì•„ì§ jwt:refreshtokensì˜ ì‚¬ìš©ì„ ë³´ì§€ ëª»í–ˆëŠ”ë°, ì´ê²ƒì€ ì‚¬ìš©ìì˜ ì¸ì¦ ìƒíƒœë¥¼ ìœ ì§€í•˜ê³  ì‚¬ìš©ìë¥¼ ë¡œê·¸ì•„ì›ƒí•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ì´ì— ëŒ€í•´ ì €ëŠ” ë‹¤ê°€ì˜¬ ë¸”ë¡œê·¸ì—ì„œ ë‹¤ë£° ì˜ˆì •ì…ë‹ˆë‹¤.</p>
<p>ê·¸ë•Œê¹Œì§€ëŠ” ì „ì²´ ì†ŒìŠ¤ ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (jwt:refreshtoken ë° jwt:accesstoken ì‚¬ìš©ë²• ë° ì‚¬ìš©ì ì¸ì¦ ë‚´ìš©ì„ frontendì— ìœ ì§€í•˜ëŠ” ë°©ë²• í¬í•¨).</p>
<p>ì½ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ë§Œì•½ ì´ ì´ì•¼ê¸°ë¥¼ ì¦ê²¼ë‹¤ë©´, ğŸ‘ ë²„íŠ¼ì„ í´ë¦­í•˜ê³  ê³µìœ í•˜ì—¬ ë‹¤ë¥¸ ì‚¬ëŒì´ ì°¾ì„ ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ì„¸ìš”! ì•„ë˜ì— ëŒ“ê¸€ì„ ë‚¨ê²¨ë„ ê´œì°®ìŠµë‹ˆë‹¤.</p>
<!-- ui-log ìˆ˜í‰í˜• -->
<p><ins class="adsbygoogle"
  style="display:block"
  data-ad-client="ca-pub-4877378276818686"
  data-ad-slot="9743150776"
  data-ad-format="auto"
  data-full-width-responsive="true"></ins></p>
<component is="script">
(adsbygoogle = window.adsbygoogle || []).push({});
</component>
<p>ë³„ë„ë¡œ ë§ì”€ë“œë¦¬ì§€ë§Œ, ì €ëŠ” í˜„ì¬ ì£¼ ë¸Œëœì¹˜ì—ì„œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰ ì¤‘ì´ì—ìš”. ìƒì‚°ì„±ì— ì§‘ì°©í•˜ì‹œê±°ë‚˜ ì‹œê°„ì„ ì² ì €íˆ ê´€ë¦¬í•˜ì‹œëŠ” ë¶„ë“¤ê³¼ ì—°ê²°í•˜ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ LinkedInì´ë‚˜ Twitterë¡œ ì—°ë½í•´ ì£¼ì„¸ìš”.</p>
</div></template>
