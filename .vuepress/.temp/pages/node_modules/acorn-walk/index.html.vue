<template><div><h1 id="acorn-ast-walker" tabindex="-1"><a class="header-anchor" href="#acorn-ast-walker" aria-hidden="true">#</a> Acorn AST walker</h1>
<p>An abstract syntax tree walker for the
<a href="https://github.com/estree/estree" target="_blank" rel="noopener noreferrer">ESTree<ExternalLinkIcon/></a> format.</p>
<h2 id="community" tabindex="-1"><a class="header-anchor" href="#community" aria-hidden="true">#</a> Community</h2>
<p>Acorn is open source software released under an
<a href="https://github.com/acornjs/acorn/blob/master/acorn-walk/LICENSE" target="_blank" rel="noopener noreferrer">MIT license<ExternalLinkIcon/></a>.</p>
<p>You are welcome to
<a href="https://github.com/acornjs/acorn/issues" target="_blank" rel="noopener noreferrer">report bugs<ExternalLinkIcon/></a> or create pull
requests on <a href="https://github.com/acornjs/acorn" target="_blank" rel="noopener noreferrer">github<ExternalLinkIcon/></a>. For questions
and discussion, please use the
<a href="https://discuss.ternjs.net" target="_blank" rel="noopener noreferrer">Tern discussion forum<ExternalLinkIcon/></a>.</p>
<h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation" aria-hidden="true">#</a> Installation</h2>
<p>The easiest way to install acorn is from <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer"><code v-pre>npm</code><ExternalLinkIcon/></a>:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> acorn-walk
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Alternately, you can download the source and build acorn yourself:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/acornjs/acorn.git
<span class="token builtin class-name">cd</span> acorn
<span class="token function">npm</span> <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="interface" tabindex="-1"><a class="header-anchor" href="#interface" aria-hidden="true">#</a> Interface</h2>
<p>An algorithm for recursing through a syntax tree is stored as an
object, with a property for each tree node type holding a function
that will recurse through such a node. There are several ways to run
such a walker.</p>
<p><strong>simple</strong><code v-pre>(node, visitors, base, state)</code> does a 'simple' walk over a
tree. <code v-pre>node</code> should be the AST node to walk, and <code v-pre>visitors</code> an object
with properties whose names correspond to node types in the <a href="https://github.com/estree/estree" target="_blank" rel="noopener noreferrer">ESTree
spec<ExternalLinkIcon/></a>. The properties should contain
functions that will be called with the node object and, if applicable
the state at that point. The last two arguments are optional. <code v-pre>base</code>
is a walker algorithm, and <code v-pre>state</code> is a start state. The default
walker will simply visit all statements and expressions and not
produce a meaningful state. (An example of a use of state is to track
scope at each point in the tree.)</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> acorn <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acorn"</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> walk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acorn-walk"</span><span class="token punctuation">)</span>

walk<span class="token punctuation">.</span><span class="token function">simple</span><span class="token punctuation">(</span>acorn<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"let x = 10"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">Literal</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Found a literal: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ancestor</strong><code v-pre>(node, visitors, base, state)</code> does a 'simple' walk over
a tree, building up an array of ancestor nodes (including the current node)
and passing the array to the callbacks as a third parameter.</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> acorn <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acorn"</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> walk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acorn-walk"</span><span class="token punctuation">)</span>

walk<span class="token punctuation">.</span><span class="token function">ancestor</span><span class="token punctuation">(</span>acorn<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"foo('hi')"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">Literal</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> ancestors</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"This literal's ancestors are:"</span><span class="token punctuation">,</span> ancestors<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">n</span> <span class="token operator">=></span> n<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>recursive</strong><code v-pre>(node, state, functions, base)</code> does a 'recursive'
walk, where the walker functions are responsible for continuing the
walk on the child nodes of their target node. <code v-pre>state</code> is the start
state, and <code v-pre>functions</code> should contain an object that maps node types
to walker functions. Such functions are called with <code v-pre>(node, state, c)</code>
arguments, and can cause the walk to continue on a sub-node by calling
the <code v-pre>c</code> argument on it with <code v-pre>(node, state)</code> arguments. The optional
<code v-pre>base</code> argument provides the fallback walker functions for node types
that aren't handled in the <code v-pre>functions</code> object. If not given, the
default walkers will be used.</p>
<p><strong>make</strong><code v-pre>(functions, base)</code> builds a new walker object by using the
walker functions in <code v-pre>functions</code> and filling in the missing ones by
taking defaults from <code v-pre>base</code>.</p>
<p><strong>full</strong><code v-pre>(node, callback, base, state)</code> does a 'full' walk over a
tree, calling the callback with the arguments (node, state, type) for
each node</p>
<p><strong>fullAncestor</strong><code v-pre>(node, callback, base, state)</code> does a 'full' walk
over a tree, building up an array of ancestor nodes (including the
current node) and passing the array to the callbacks as a third
parameter.</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> acorn <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acorn"</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> walk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acorn-walk"</span><span class="token punctuation">)</span>

walk<span class="token punctuation">.</span><span class="token function">full</span><span class="token punctuation">(</span>acorn<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"1 + 1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">node</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">There's a </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> node at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>ch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>findNodeAt</strong><code v-pre>(node, start, end, test, base, state)</code> tries to locate
a node in a tree at the given start and/or end offsets, which
satisfies the predicate <code v-pre>test</code>. <code v-pre>start</code> and <code v-pre>end</code> can be either <code v-pre>null</code>
(as wildcard) or a number. <code v-pre>test</code> may be a string (indicating a node
type) or a function that takes <code v-pre>(nodeType, node)</code> arguments and
returns a boolean indicating whether this node is interesting. <code v-pre>base</code>
and <code v-pre>state</code> are optional, and can be used to specify a custom walker.
Nodes are tested from inner to outer, so if two nodes match the
boundaries, the inner one will be preferred.</p>
<p><strong>findNodeAround</strong><code v-pre>(node, pos, test, base, state)</code> is a lot like
<code v-pre>findNodeAt</code>, but will match any node that exists 'around' (spanning)
the given position.</p>
<p><strong>findNodeAfter</strong><code v-pre>(node, pos, test, base, state)</code> is similar to
<code v-pre>findNodeAround</code>, but will match all nodes <em>after</em> the given position
(testing outer nodes before inner nodes).</p>
</div></template>
