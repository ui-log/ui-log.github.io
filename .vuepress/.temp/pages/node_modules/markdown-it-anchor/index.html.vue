<template><div><h1 id="markdown-it-anchor" tabindex="-1"><a class="header-anchor" href="#markdown-it-anchor" aria-hidden="true">#</a> markdown-it-anchor <a href="https://www.npmjs.org/package/markdown-it-anchor" target="_blank" rel="noopener noreferrer"><img src="http://img.shields.io/npm/v/markdown-it-anchor.svg?style=flat-square" alt="npm version"><ExternalLinkIcon/></a></h1>
<blockquote>
<p>A markdown-it plugin that adds an <code v-pre>id</code> attribute to headings and
optionally permalinks.</p>
</blockquote>
<p>English | <RouterLink to="/node_modules/markdown-it-anchor/README-zh_CN.html">中文 (v7.0.1)</RouterLink></p>
<h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview" aria-hidden="true">#</a> Overview</h2>
<p>This plugin adds an <code v-pre>id</code> attribute to headings, e.g. <code v-pre>## Foo</code> becomes
<code v-pre>&lt;h2 id=&quot;foo&quot;&gt;Foo&lt;/h2&gt;</code>.</p>
<p>Optionally it can also include <a href="#permalinks">permalinks</a>, e.g.
<code v-pre>&lt;h2 id=&quot;foo&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#foo&quot;&gt;Foo&lt;/a&gt;&lt;/h2&gt;</code>
and a bunch of other variants!</p>
<ul>
<li><a href="#usage"><strong>Usage</strong></a></li>
<li><a href="#user-friendly-urls">User-friendly URLs</a></li>
<li><a href="#manually-setting-the-id-attribute">Manually setting the <code v-pre>id</code> attribute</a></li>
<li><a href="#compatible-table-of-contents-plugin">Compatible table of contents plugin</a></li>
<li><a href="#parsing-headings-from-html-blocks">Parsing headings from HTML blocks</a></li>
<li><a href="#browser-example">Browser example</a></li>
<li><a href="#permalinks"><strong>Permalinks</strong></a>
<ul>
<li><a href="#header-link">Header link</a></li>
<li><a href="#link-after-header">Link after header</a></li>
<li><a href="#link-inside-header">Link inside header</a></li>
<li><a href="#aria-hidden">ARIA hidden</a></li>
<li><a href="#custom-permalink">Custom permalink</a></li>
</ul>
</li>
<li><a href="#debugging">Debugging</a></li>
<li><a href="#development">Development</a></li>
</ul>
<h2 id="usage" tabindex="-1"><a class="header-anchor" href="#usage" aria-hidden="true">#</a> Usage</h2>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>See a <a href="https://jsfiddle.net/9ukc8dy6/" target="_blank" rel="noopener noreferrer">demo as JSFiddle<ExternalLinkIcon/></a>.</p>
<p>The <code v-pre>opts</code> object can contain:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>level</code></td>
<td>Minimum level to apply anchors, or array of selected levels.</td>
<td>1</td>
</tr>
<tr>
<td><code v-pre>permalink</code></td>
<td>A function to render permalinks, see <a href="#permalinks">permalinks</a> below.</td>
<td><code v-pre>undefined</code></td>
</tr>
<tr>
<td><code v-pre>slugify</code></td>
<td>A custom slugification function.</td>
<td>See <a href="https://github.com/valeriangalliat/markdown-it-anchor/blob/master/index.js#L3" target="_blank" rel="noopener noreferrer"><code v-pre>index.js</code><ExternalLinkIcon/></a></td>
</tr>
<tr>
<td><code v-pre>callback</code></td>
<td>Called with token and info after rendering.</td>
<td><code v-pre>undefined</code></td>
</tr>
<tr>
<td><code v-pre>getTokensText</code></td>
<td>A custom function to get the text contents of the title from its tokens.</td>
<td>See <a href="https://github.com/valeriangalliat/markdown-it-anchor/blob/master/index.js#L5" target="_blank" rel="noopener noreferrer"><code v-pre>index.js</code><ExternalLinkIcon/></a></td>
</tr>
<tr>
<td><code v-pre>tabIndex</code></td>
<td>Value of the <code v-pre>tabindex</code> attribute on headings, set to <code v-pre>false</code> to disable.</td>
<td><code v-pre>-1</code></td>
</tr>
<tr>
<td><code v-pre>uniqueSlugStartIndex</code></td>
<td>Index to start with when making duplicate slugs unique.</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>All headers greater than the minimum <code v-pre>level</code> will have an <code v-pre>id</code> attribute
with a slug of their content. For example, you can set <code v-pre>level</code> to 2 to
add anchors to all headers but <code v-pre>h1</code>. You can also pass an array of
header levels to apply the anchor, like <code v-pre>[2, 3]</code> to have an anchor on
only level 2 and 3 headers.</p>
<p>If a <code v-pre>permalink</code> renderer is given, it will be called for each matching header
to add a permalink. See <a href="#permalinks">permalinks</a> below.</p>
<p>If a <code v-pre>slugify</code> function is given, you can decide how to transform a
heading text to a URL slug. See <a href="#user-friendly-urls">user-friendly URLs</a>.</p>
<p>The <code v-pre>callback</code> option is a function that will be called at the end of
rendering with the <code v-pre>token</code> and an <code v-pre>info</code> object.  The <code v-pre>info</code> object has
<code v-pre>title</code> and <code v-pre>slug</code> properties with the token content and the slug used
for the identifier.</p>
<p>We set by default <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex" target="_blank" rel="noopener noreferrer"><code v-pre>tabindex=&quot;-1&quot;</code><ExternalLinkIcon/></a>
on headers. This marks the headers as focusable elements that are not
reachable by keyboard navigation. The effect is that screen readers will
read the title content when it's being jumped to. Outside of screen
readers, the experience is the same as not setting that attribute. You
can override this behavior with the <code v-pre>tabIndex</code> option. Set it to <code v-pre>false</code>
to remove the attribute altogether, otherwise the value will be used as
attribute value.</p>
<p>Finally, you can customize how the title text is extracted from the
markdown-it tokens (to later generate the slug). See <a href="#user-friendly-urls">user-friendly URLs</a>.</p>
<h2 id="user-friendly-urls" tabindex="-1"><a class="header-anchor" href="#user-friendly-urls" aria-hidden="true">#</a> User-friendly URLs</h2>
<p>Starting from v5.0.0, markdown-it-anchor dropped the <a href="https://github.com/jprichardson/string.js" target="_blank" rel="noopener noreferrer"><code v-pre>string</code><ExternalLinkIcon/></a>
package to retain our core value of being an impartial and secure
library. Nevertheless, users looking for backward compatibility may want
the old <code v-pre>slugify</code> function:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> string
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> string <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'string'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">slugify</span> <span class="token operator">=</span> <span class="token parameter">s</span> <span class="token operator">=></span> <span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slugify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> slugify <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Another popular library for this is <a href="https://github.com/sindresorhus/slugify" target="_blank" rel="noopener noreferrer"><code v-pre>@sindresorhus/slugify</code><ExternalLinkIcon/></a>,
which have better Unicode support and other cool features:</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @sindresorhus/slugify
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> slugify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@sindresorhus/slugify'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token function-variable function">slugify</span><span class="token operator">:</span> <span class="token parameter">s</span> <span class="token operator">=></span> <span class="token function">slugify</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Additionally, if you want to further customize the title that gets
passed to the <code v-pre>slugify</code> function, you can do so by customizing the
<code v-pre>getTokensText</code> function, that gets the plain text from a list of
markdown-it inline tokens:</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getTokensText</span> <span class="token punctuation">(</span><span class="token parameter">tokens</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> tokens
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">token</span> <span class="token operator">=></span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">'html_inline'</span><span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=></span> t<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> getTokensText <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>By default we include only <code v-pre>text</code> and <code v-pre>code_inline</code> tokens, which
appeared to be a sensible approach for the vast majority of use cases.</p>
<p>An alternative approach is to include every token's content except for
<code v-pre>html_inline</code> and <code v-pre>image</code> tokens, which yields the exact same results as
the previous approach with a stock markdown-it, but would also include
custom tokens added by any of your markdown-it plugins, which might or
might not be desirable for you. Now you have the option!</p>
<h2 id="manually-setting-the-id-attribute" tabindex="-1"><a class="header-anchor" href="#manually-setting-the-id-attribute" aria-hidden="true">#</a> Manually setting the <code v-pre>id</code> attribute</h2>
<p>You might want to explicitly set the <code v-pre>id</code> attribute of your headings
from the Markdown document, for example to keep them consistent across
translations.</p>
<p>markdown-it-anchor is designed to reuse any existing <code v-pre>id</code>, making <a href="https://www.npmjs.com/package/markdown-it-attrs" target="_blank" rel="noopener noreferrer">markdown-it-attrs<ExternalLinkIcon/></a>
a perfect fit for this use case. Make sure to load it before markdown-it-anchor!</p>
<p>Then you can do something like this:</p>
<h1 id="your-title-your-custom-id" tabindex="-1"><a class="header-anchor" href="#your-title-your-custom-id" aria-hidden="true">#</a> Your title {#your-custom-id}</h1>
<p>The anchor link will reuse the <code v-pre>id</code> that you explicitly defined.</p>
<h2 id="compatible-table-of-contents-plugin" tabindex="-1"><a class="header-anchor" href="#compatible-table-of-contents-plugin" aria-hidden="true">#</a> Compatible table of contents plugin</h2>
<p>Looking for an automatic table of contents (TOC) generator? Take a look at
<a href="https://www.npmjs.com/package/markdown-it-toc-done-right" target="_blank" rel="noopener noreferrer">markdown-it-toc-done-right<ExternalLinkIcon/></a>
it's made from the ground to be a great companion of this plugin.</p>
<h2 id="parsing-headings-from-html-blocks" tabindex="-1"><a class="header-anchor" href="#parsing-headings-from-html-blocks" aria-hidden="true">#</a> Parsing headings from HTML blocks</h2>
<p>markdown-it-anchor doesn't parse HTML blocks, so headings defined in
HTML blocks will be ignored. If you need to add anchors to both HTML
headings and Markdown headings, the easiest way would be to do it on the
final HTML rather than during the Markdown parsing phase:</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> parse <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'node-html-parser'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> h <span class="token keyword">of</span> root<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'h1, h2, h3, h4, h5, h6'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> slug <span class="token operator">=</span> h<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">slugify</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span>
  h<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> slug<span class="token punctuation">)</span>
  h<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;a href="#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>slug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>h<span class="token punctuation">.</span>innerHTML<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/a></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Or with a (not accessible) GitHub-style anchor, replace the
<code v-pre>h.innerHTML</code> part with:</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code>h<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">'afterbegin'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;a class="anchor" aria-hidden="true" href="#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>slug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">">🔗&lt;/a> </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>While this still needs extra work like handling duplicated slugs and
IDs, this should give you a solid base.</p>
<p>That said if you really want to use markdown-it-anchor for this even
though it's not designed to, you can do like npm does with their
<a href="https://github.com/npm/marky-markdown" target="_blank" rel="noopener noreferrer">marky-markdown<ExternalLinkIcon/></a> parser, and
<a href="https://github.com/npm/marky-markdown/blob/master/lib/plugin/html-heading.js" target="_blank" rel="noopener noreferrer">transform the <code v-pre>html_block</code> tokens<ExternalLinkIcon/></a>
into a sequence of <code v-pre>heading_open</code>, <code v-pre>inline</code>, and <code v-pre>heading_close</code> tokens
that can be handled by markdown-it-anchor:</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@npmcorp/marky-markdown/lib/plugin/html-heading'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>While they use regexes to parse the HTML and it won't gracefully handle
any arbitrary HTML, it should work okay for the happy path, which might
be good enough for you.</p>
<p>You might also want to check <a href="https://github.com/valeriangalliat/markdown-it-anchor/issues/105#issuecomment-907323858" target="_blank" rel="noopener noreferrer">this implementation<ExternalLinkIcon/></a>
which uses <a href="https://www.npmjs.com/package/cheerio" target="_blank" rel="noopener noreferrer">Cheerio<ExternalLinkIcon/></a> for a more
solid parsing, including support for HTML attributes.</p>
<p>The only edge cases I see it failing with are multiple headings defined
in the same HTML block with arbitrary content between them, or headings
where the opening and closing tag are defined in separate <code v-pre>html_block</code>
tokens, both which should very rarely happen.</p>
<p>If you need a bulletproof implementation, I would recommend the first
HTML parser approach I documented instead.</p>
<h2 id="browser-example" tabindex="-1"><a class="header-anchor" href="#browser-example" aria-hidden="true">#</a> Browser example</h2>
<p>See <RouterLink to="/node_modules/markdown-it-anchor/example.html"><code v-pre>example.html</code></RouterLink>.</p>
<h2 id="permalinks" tabindex="-1"><a class="header-anchor" href="#permalinks" aria-hidden="true">#</a> Permalinks</h2>
<p>Version 8.0.0 completely reworked the way permalinks work in order to
offer more accessible options out of the box. You can also <a href="#custom-permalink">make your own permalink</a>.</p>
<p>Instead of a single default way of rendering permalinks (which used to
have a poor UX on screen readers), we now have multiple styles of
permalinks for you to chose from.</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

md<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">permalink</span><span class="token operator">:</span> anchor<span class="token punctuation">.</span>permalink<span class="token punctuation">[</span>styleOfPermalink<span class="token punctuation">]</span><span class="token punctuation">(</span>permalinkOpts<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here, <code v-pre>styleOfPermalink</code> is one of the available styles documented
below, and <code v-pre>permalinkOpts</code> is an options object.</p>
<div id="common-options"></div>
<p>All renderers share a common set of options:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>class</code></td>
<td>The class of the permalink anchor.</td>
<td><code v-pre>header-anchor</code></td>
</tr>
<tr>
<td><code v-pre>symbol</code></td>
<td>The symbol in the permalink anchor.</td>
<td><code v-pre>#</code></td>
</tr>
<tr>
<td><code v-pre>renderHref</code></td>
<td>A custom permalink <code v-pre>href</code> rendering function.</td>
<td>See <a href="permalink.js"><code v-pre>permalink.js</code></a></td>
</tr>
<tr>
<td><code v-pre>renderAttrs</code></td>
<td>A custom permalink attributes rendering function.</td>
<td>See <a href="permalink.js"><code v-pre>permalink.js</code></a></td>
</tr>
</tbody>
</table>
<p>For the <code v-pre>symbol</code>, you may want to use the <a href="http://graphemica.com/%F0%9F%94%97" target="_blank" rel="noopener noreferrer">link symbol<ExternalLinkIcon/></a>,
or a symbol from your favorite web font.</p>
<h3 id="header-link" tabindex="-1"><a class="header-anchor" href="#header-link" aria-hidden="true">#</a> Header link</h3>
<p>This style wraps the header itself in an anchor link. It doesn't use the
<code v-pre>symbol</code> option as there's no symbol needed in the markup (though you
could add it with CSS using <code v-pre>::before</code> if you like).</p>
<p>It's so simple it doesn't have any behaviour to custom, and it's also
accessible out of the box without any further configuration, hence it
doesn't have other options than the common ones described above.</p>
<p>You can find this style on the <a href="https://developer.mozilla.org/en-US/docs/Web" target="_blank" rel="noopener noreferrer">MDN<ExternalLinkIcon/></a> as well as <a href="https://httparchive.org/reports/state-of-the-web" target="_blank" rel="noopener noreferrer">HTTP Archive<ExternalLinkIcon/></a> and their
<a href="https://almanac.httparchive.org/en/2020/table-of-contents" target="_blank" rel="noopener noreferrer">Web Almanac<ExternalLinkIcon/></a>, which to me is a good sign that this is a thoughtful way of
implementing permalinks. This is also the style that I chose for my own
<a href="https://www.codejam.info/" target="_blank" rel="noopener noreferrer">blog<ExternalLinkIcon/></a>.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>safariReaderFix</code></td>
<td>Add a <code v-pre>span</code> inside the link so Safari shows headings in reader view.</td>
<td><code v-pre>false</code> (for backwards compatibility)</td>
</tr>
<tr>
<td></td>
<td>See <a href="#common-options">common options</a>.</td>
<td></td>
</tr>
</tbody>
</table>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

md<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">permalink</span><span class="token operator">:</span> anchor<span class="token punctuation">.</span>permalink<span class="token punctuation">.</span><span class="token function">headerLink</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header-anchor<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The main caveat of this approach is that you can't include links inside
headers. If you do, consider the other styles.</p>
<p>Also note that this pattern <a href="https://www.leereamsnyder.com/blog/making-headings-with-links-show-up-in-safari-reader" target="_blank" rel="noopener noreferrer">breaks reader mode in Safari<ExternalLinkIcon/></a>,
an issue you can also notice on the referenced websites above. This was
already <a href="https://bugs.webkit.org/show_bug.cgi?id=225609#c2" target="_blank" rel="noopener noreferrer">reported to Apple<ExternalLinkIcon/></a>
but their bug tracker is not public. In the meantime, a fix mentioned in
the article above is to insert a <code v-pre>span</code> inside the link. You can use the
<code v-pre>safariReaderFix</code> option to enable it.</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

md<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">permalink</span><span class="token operator">:</span> anchor<span class="token punctuation">.</span>permalink<span class="token punctuation">.</span><span class="token function">headerLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">safariReaderFix</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header-anchor<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="link-after-header" tabindex="-1"><a class="header-anchor" href="#link-after-header" aria-hidden="true">#</a> Link after header</h3>
<p>If you want to customize further the screen reader experience of your
permalinks, this style gives you much more freedom than the <a href="#header-link">header link</a>.</p>
<p>It works by leaving the header itself alone, and adding the permalink
<em>after</em> it, giving you different methods of customizing the assistive
text. It makes the permalink symbol <code v-pre>aria-hidden</code> to not pollute the
experience, and leverages a <code v-pre>visuallyHiddenClass</code> to hide the assistive
text from the visual experience.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>style</code></td>
<td>The (sub) style of link, one of <code v-pre>visually-hidden</code>, <code v-pre>aria-label</code>, <code v-pre>aria-describedby</code> or <code v-pre>aria-labelledby</code>.</td>
<td><code v-pre>visually-hidden</code></td>
</tr>
<tr>
<td><code v-pre>assistiveText</code></td>
<td>A function that takes the title and returns the assistive text.</td>
<td><code v-pre>undefined</code>, required for <code v-pre>visually-hidden</code> and <code v-pre>aria-label</code> styles</td>
</tr>
<tr>
<td><code v-pre>visuallyHiddenClass</code></td>
<td>The class you use to make an element visually hidden.</td>
<td><code v-pre>undefined</code>, required for <code v-pre>visually-hidden</code> style</td>
</tr>
<tr>
<td><code v-pre>space</code></td>
<td>Add a space between the assistive text and the permalink symbol.</td>
<td><code v-pre>true</code></td>
</tr>
<tr>
<td><code v-pre>placement</code></td>
<td>Placement of the permalink symbol relative to the assistive text, can be <code v-pre>before</code> or <code v-pre>after</code> the header.</td>
<td><code v-pre>after</code></td>
</tr>
<tr>
<td><code v-pre>wrapper</code></td>
<td>Opening and closing wrapper string, e.g. <code v-pre>['&lt;div class=&quot;wrapper&quot;&gt;', '&lt;/div&gt;']</code>.</td>
<td><code v-pre>null</code></td>
</tr>
<tr>
<td></td>
<td>See <a href="#common-options">common options</a>.</td>
<td></td>
</tr>
</tbody>
</table>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

md<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">permalink</span><span class="token operator">:</span> anchor<span class="token punctuation">.</span>permalink<span class="token punctuation">.</span><span class="token function">linkAfterHeader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'visually-hidden'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">assistiveText</span><span class="token operator">:</span> <span class="token parameter">title</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Permalink to “</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">”</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">visuallyHiddenClass</span><span class="token operator">:</span> <span class="token string">'visually-hidden'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">wrapper</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'&lt;div class="wrapper">'</span><span class="token punctuation">,</span> <span class="token string">'&lt;/div>'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrapper<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header-anchor<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>visually-hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Permalink to “Title”<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>#<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>By using a visually hidden element for the assistive text, we make sure
that the assistive text can be picked up by translation services, as
most of the popular translation services (including Google Translate)
currently ignore <code v-pre>aria-label</code>.</p>
<p>If you prefer an alternative method for the assistive text, see other
styles:</p>
<details>
<summary><code>aria-label</code> variant</summary>
<p>This removes the need from a visually hidden <code v-pre>span</code>, but will likely
hurt the permalink experience when using a screen reader through a
translation service.</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

md<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">permalink</span><span class="token operator">:</span> anchor<span class="token punctuation">.</span>permalink<span class="token punctuation">.</span><span class="token function">linkAfterHeader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'aria-label'</span>
    <span class="token function-variable function">assistiveText</span><span class="token operator">:</span> <span class="token parameter">title</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Permalink to “</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">”</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header-anchor<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#title<span class="token punctuation">"</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Permalink to “Title”<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>#<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></details>
<details>
<summary><code>aria-describedby</code> and <code>aria-labelledby</code> variants</summary>
<p>This removes the need to customize the assistive text to your locale and
doesn't need a visually hidden <code v-pre>span</code> either, but since the anchor will
be described by just the text of the title without any context, it might
be confusing.</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

md<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">permalink</span><span class="token operator">:</span> anchor<span class="token punctuation">.</span>permalink<span class="token punctuation">.</span><span class="token function">linkAfterHeader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'aria-describedby'</span> <span class="token comment">// Or `aria-labelledby`</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header-anchor<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#title<span class="token punctuation">"</span></span> <span class="token attr-name">aria-describedby</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>#<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></details>
<h3 id="link-inside-header" tabindex="-1"><a class="header-anchor" href="#link-inside-header" aria-hidden="true">#</a> Link inside header</h3>
<p>This is the equivalent of the default permalink in previous versions.
The reason it's not the first one in the list is because this method has
accessibility issues.</p>
<p>If you use a symbol like just <code v-pre>#</code> without adding any markup around,
screen readers will read it as part of every heading (in the case of
<code v-pre>#</code>, it could be read &quot;pound&quot;, &quot;number&quot; or &quot;number sign&quot;) meaning that
if you title is &quot;my beautiful title&quot;, it will read &quot;number sign my
beautiful title&quot; for example. For other common symbols, <code v-pre>🔗</code> is usually
read as &quot;link symbol&quot; and <code v-pre>¶</code> as &quot;pilcrow&quot;.</p>
<p>Additionally, screen readers users commonly request the list of all
links in the page, so they'll be flooded with &quot;number sign, number sign,
number sign&quot; for each of your headings.</p>
<p>I would highly recommend using one of the markups above which have a
better experience, but if you really want to use this markup, make sure
to pass accessible HTML as <code v-pre>symbol</code> to make things usable, like in the
example below, but even that has some flaws.</p>
<p>With that said, this permalink allows the following options:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>space</code></td>
<td>Add a space between the header text and the permalink symbol. Set it to a string to customize the space (e.g. <code v-pre>&amp;nbsp;</code>).</td>
<td><code v-pre>true</code></td>
</tr>
<tr>
<td><code v-pre>placement</code></td>
<td>Placement of the permalink, can be <code v-pre>before</code> or <code v-pre>after</code> the header. This option used to be called <code v-pre>permalinkBefore</code>.</td>
<td><code v-pre>after</code></td>
</tr>
<tr>
<td><code v-pre>ariaHidden</code></td>
<td>Whether to add <code v-pre>aria-hidden=&quot;true&quot;</code>, see <a href="#aria-hidden">ARIA hidden</a>.</td>
<td><code v-pre>false</code></td>
</tr>
<tr>
<td></td>
<td>See <a href="#common-options">common options</a>.</td>
<td></td>
</tr>
</tbody>
</table>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

md<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">permalink</span><span class="token operator">:</span> anchor<span class="token punctuation">.</span>permalink<span class="token punctuation">.</span><span class="token function">linkInsideHeader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">symbol</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;span class="visually-hidden">Jump to heading&lt;/span>
      &lt;span aria-hidden="true">#&lt;/span>
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">placement</span><span class="token operator">:</span> <span class="token string">'before'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header-anchor<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>visually-hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Jump to heading<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>#<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
  Title
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>While this example allows more accessible anchors with the same markup
as previous versions of markdown-it-anchor, it's still not ideal. The
assistive text for permalinks will be read as part of the heading when
listing all the titles of the page, e.g. &quot;jump to heading title 1, jump
to heading title 2&quot; and so on. Also that assistive text is not very
useful when listing the links in the page (which will read &quot;jump to
heading, jump to heading, jump to heading&quot; for each of your permalinks).</p>
<h3 id="aria-hidden" tabindex="-1"><a class="header-anchor" href="#aria-hidden" aria-hidden="true">#</a> ARIA hidden</h3>
<p>This is just an alias for <a href="#link-inside-header"><code v-pre>linkInsideHeader</code></a> with
<code v-pre>ariaHidden: true</code> by default, to mimic GitHub's way of rendering
permalinks.</p>
<p>Setting <code v-pre>aria-hidden=&quot;true&quot;</code> makes the permalink explicitly inaccessible
instead of having the permalink and its symbol being read by screen
readers as part of every single headings (which was a pretty terrible
experience).</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it-anchor'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> md <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'markdown-it'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

md<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>anchor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">permalink</span><span class="token operator">:</span> anchor<span class="token punctuation">.</span>permalink<span class="token punctuation">.</span><span class="token function">ariaHidden</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">placement</span><span class="token operator">:</span> <span class="token string">'before'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header-anchor<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#title<span class="token punctuation">"</span></span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>#<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span> Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>While no experience might be arguably better than a bad experience, I
would instead recommend using one of the above renderers to provide an
accessible experience. My favorite one is the <a href="#header-link">header link</a>,
which is also the simplest one.</p>
<h3 id="custom-permalink" tabindex="-1"><a class="header-anchor" href="#custom-permalink" aria-hidden="true">#</a> Custom permalink</h3>
<p>If none of those options suit you, you can always make your own
renderer! Take inspiration from <a href="permalink.js">the code behind all permalinks</a>.</p>
<p>The signature of the function you pass in the <code v-pre>permalink</code> option is the
following:</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">renderPermalink</span> <span class="token punctuation">(</span><span class="token parameter">slug<span class="token punctuation">,</span> opts<span class="token punctuation">,</span> state<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Where <code v-pre>opts</code> are the markdown-it-anchor options, <code v-pre>state</code> is a
markdown-it <a href="https://github.com/markdown-it/markdown-it" target="_blank" rel="noopener noreferrer"><code v-pre>StateCore</code><ExternalLinkIcon/></a>
instance, and <code v-pre>idx</code> is the index of the <code v-pre>heading_open</code> token in the
<code v-pre>state.tokens</code> array. That array contains <a href="https://markdown-it.github.io/markdown-it/#Token" target="_blank" rel="noopener noreferrer"><code v-pre>Token</code><ExternalLinkIcon/></a>
objects.</p>
<p>To make sense of the &quot;token stream&quot; and the way token objects are
organized, you will probably want to read the <a href="https://github.com/markdown-it/markdown-it/blob/master/docs/architecture.md" target="_blank" rel="noopener noreferrer">markdown-it design principles<ExternalLinkIcon/></a>
page.</p>
<p>This function can freely modify the token stream (<code v-pre>state.tokens</code>),
usually around the given <code v-pre>idx</code>, to construct the anchor.</p>
<p>Because of the way the token stream works, a <code v-pre>heading_open</code> token is
usually followed by a <code v-pre>inline</code> token that contains the actual text (and
inline markup) of the heading, and finally a <code v-pre>heading_close</code> token. This
is why you'll see most built-in permalink renderers touch
<code v-pre>state.tokens[idx + 1]</code>, because they update the contents of the
<code v-pre>inline</code> token that follows a <code v-pre>heading_open</code>.</p>
<h2 id="debugging" tabindex="-1"><a class="header-anchor" href="#debugging" aria-hidden="true">#</a> Debugging</h2>
<p>If you want to debug this library more easily, we support source maps.</p>
<p>Use the <a href="https://www.npmjs.com/package/source-map-support" target="_blank" rel="noopener noreferrer">source-map-support<ExternalLinkIcon/></a>
module to enable it with Node.js.</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token function">node</span> -r source-map-support/register your-script.js
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="development" tabindex="-1"><a class="header-anchor" href="#development" aria-hidden="true">#</a> Development</h2>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token comment"># Build the library in the `dist/` directory.</span>
<span class="token function">npm</span> run build

<span class="token comment"># Watch file changes to update `dist/`.</span>
<span class="token function">npm</span> run dev

<span class="token comment"># Run tests, will use the build version so make sure to build after</span>
<span class="token comment"># making changes.</span>
<span class="token function">npm</span> <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></template>
